---
title: "Acute Changes in CEWL as a Function of Temperature: Deceased Lizards"
author: "Calvin Davis, Savannah Weaver"
date: "2022"
output: 
  rmdformats::html_clean:
    highlight: tango
    thumbnails: FALSE
    toc: TRUE
    toc_depth: 3
---


# Packages

```{r setup, echo=T, results='hide', message=FALSE}
if (!require("tidyverse")) install.packages("tidyverse") 
library("tidyverse") #tidyr, ggplot, dplyr, etc
if (!require("ggpubr")) install.packages("ggpubr") 
library("ggpubr") # arrange multi-figures
if (!require("RColorBrewer")) install.packages("RColorBrewer") 
library("RColorBrewer") # colors
if (!require("rmdformats")) install.packages("rmdformats")
library("rmdformats") # clean html R markdown format
```



# Background

This code goes through data wrangling, summary statistics, and figures for data on two deceased lizards that we opportunistically studied. Their data are part of a study on the rate of change of cutaneous evaporative water loss (CEWL) in response to temperature change in Western Fence Lizards (*Sceloporus occidentalis*). Data was collected and analyzed by Calvin Davis and Savannah Weaver, and the project was advised by Dr. Emily Taylor at California Polytechnic State University. 


 
# Load Data


## Live Lizzies

Data for average CEWL at each temperature.

```{r}
live_CEWL_per_temp <- read_rds("Data/CEWL_by_temp_tmt.RDS")
summary(live_CEWL_per_temp)
```



## CEWL

Get filenames:

```{r CEWL filenames}
# make a list of file names of all data to load in
filenames_dead_aquaflux <- (list.files(path = "./Data/dead lizards/R format", 
                                 pattern = "csv"))[1:6]
```

Make a function that will read in the data from each csv, name and organize the data correctly. 

Variables: 

- time sec = time recording from evaporimeter 
- CEWL_g_m2h = cutaneous evaporative water loss 
- msmt_temp_C = ambient temperature in Celsius at the time of CEWL measurement
- msmt_RH_percent = % relative ambient humidity at the time of CEWL measurement

```{r function to load CEWL data}
read_dead_CEWL_file <- function(filename_dead) {
  
   # save helpful info
   name <- trimws(substr(filename_dead, 6, 13))
   treatment <- trimws(substr(filename_dead, 15, 21))
   
   ## load file
   dat_dead <- read.csv(file.path("./Data/dead lizards/R format", filename_dead), 
                        header = TRUE) %>%
      # select only the relevant values
      dplyr::select(time_sec = 'Time..sec.',
                    CEWL_g_m2h = 'Flux..g..m2h..', 
                    msmt_temp_C = 'AmbT..C.', 
                    msmt_RH_percent = 'AmbRH....'
                    ) %>%
      # use filename info     
      dplyr::mutate(lizard_ID = (name),
                    treatment = (treatment))
   # return the dataframe for that single csv file
   dat_dead
   
}
```



Apply function to all files, compile, and incorporate timing:

```{r load and filter CEWL data}
# apply function to get data from all csvs
all_dead_CEWL_data <- lapply(filenames_dead_aquaflux, read_dead_CEWL_file) %>%
   # paste all data files together into one df by row
   reduce(rbind) %>%
   # properly format data classes
   mutate(lizard_ID = as.factor(lizard_ID),
          treatment = as.factor(treatment),
          liz_tmt = as.factor(paste(substr(lizard_ID, 8, 8), treatment)),
          time_sec = floor(as.numeric(time_sec)),
          CEWL_g_m2h = as.numeric(CEWL_g_m2h),
          msmt_temp_C = as.numeric(msmt_temp_C),
          msmt_RH_percent = as.numeric(msmt_RH_percent))

summary(all_dead_CEWL_data)
```




### Equilibration

The evaporimeter also takes 1-2 minutes to equilibrate to the lizard at the start of each time series, so we want to estimate when equilibration was complete for each lizard.

Previously, we found the peak during the equilibrium period, then cut out that data up to 60 seconds after the peak. However, not all the data for the dead lizards decreased again, so we will just filter out the first 90 seconds (1.5 minutes).

```{r find when equilibrated}
ggplot(data = all_dead_CEWL_data,
       aes(x = time_sec,
           y = CEWL_g_m2h, 
           color = treatment)) + 
   geom_point(size = 0.5, alpha = 0.5) + 
   geom_vline(xintercept = 70)
```



filter:

```{r}
dead_CEWL_data_filtered <- all_dead_CEWL_data %>%
  dplyr::filter(time_sec > 89)
```







### Time Series df 

add start times/ actual times and relative CEWL:

```{r}
start_CEWL <- dead_CEWL_data_filtered %>%
  dplyr::filter(time_sec == 90) %>%
  dplyr::select(lizard_ID, treatment,
                start_CEWL = CEWL_g_m2h)

CEWL_time <- dead_CEWL_data_filtered %>%
          # get actual time for joining temperature data
  mutate(start_time = case_when(lizard_ID == "lizard A" & treatment == "control" ~
                                  "15:07:15",
                                lizard_ID == "lizard A" & treatment == "cooling" ~
                                  "16:16:25",
                                lizard_ID == "lizard A" & treatment == "heating" ~
                                  "17:01:05",
                                lizard_ID == "lizard D" & treatment == "control" ~
                                  "14:42:10",
                                lizard_ID == "lizard D" & treatment == "cooling" ~
                                  "16:39:32",
                                lizard_ID == "lizard D" & treatment == "heating" ~
                                  "15:38:19"
                                  ),
         start_date_time = as.POSIXct(paste("2022-06-29", start_time, sep = " "), 
                                      format = "%Y-%m-%d %H:%M:%S"),
         date_time = start_date_time + time_sec) %>%
  left_join(start_CEWL, by = c("lizard_ID", "treatment")) %>%
  mutate(relative_CEWL = CEWL_g_m2h - start_CEWL,
         # get diff time format
         time_min = time_sec/60) %>%
  dplyr::select(lizard_ID, treatment, liz_tmt, 
                time_min, date_time,
                CEWL_g_m2h, relative_CEWL)

summary(CEWL_time)
```





## Thermocouples

Get filenames:

```{r TC filenames}
# make a list of file names of all data to load in
filenames_dead_TC <- (list.files(path = "./Data/dead lizards/TC", 
                                 pattern = "csv"))[2:6]
```

Make a function that will read in the data from each csv, name and organize the data correctly. 

```{r function to load TC data}
read_dead_TC_file <- function(filename_dead) {
  
   # save helpful info
   name <- trimws(substr(filename_dead, 12, 12))
   treatment <- trimws(substr(filename_dead, 13, 20))
   
   ## load file
   dat_dead <- read.csv(file.path("./Data/dead lizards/TC", filename_dead), 
                        header = TRUE) %>%
      # use filename info     
      dplyr::mutate(lizard_ID = paste("lizard",name, sep = " "),
                    treatment = (treatment))
   # return the dataframe for that single csv file
   dat_dead
}
```


Apply function to all files, compile, and incorporate timing:

```{r load and filter TC data}
# apply function to get data from all csvs
all_dead_TC_data <- lapply(filenames_dead_TC, read_dead_TC_file) %>%
   # paste all data files together into one df by row
   reduce(rbind) %>%
   # get rid of empty cells
   dplyr::filter(complete.cases(Time, Value)) %>%
   # properly format data classes
   mutate(lizard_ID = as.factor(lizard_ID),
          treatment = as.factor(treatment),
          date_time = as.POSIXct(paste(Date, Time), 
                                 format = "%m/%d/%y %H:%M:%S")) %>%
  dplyr::select(date_time, lizard_ID, treatment, temp_C = Value)

summary(all_dead_TC_data)
```

### TC Calibration

The thermocouples tend to drift 1-2 C off of the true temperature, so we collected reference data to make a calibration curve for each one.

Get all the data and organize:

```{r load TC calibration data}
calibration_logger <- read.csv("./Data/dead lizards/TC/thermocouple_calibration.csv",  header = TRUE) %>%
  mutate(date_time = round(as.POSIXct(paste(Date, Time), 
                                      format = "%m/%d/%y %H:%M:%S"), 
                           "mins"))

calibration_reference <- read.csv("./Data/dead lizards/TC/thermocouple_reference.csv",  header = TRUE)  %>%
   mutate(date = "6/21/22",
          date_time = as.POSIXct(paste(date, time), format = "%m/%d/%y %H:%M")) %>%
  dplyr::select(date_time, ref_temp_C)

calibration_A <- calibration_logger %>% # port 1 = TC A = lizard A
  dplyr::select(date_time, temp_C = Value, Unit) %>%
  left_join(calibration_reference, by = 'date_time') %>%
  dplyr::filter(complete.cases(ref_temp_C))

calibration_D <- calibration_logger %>% # port 4 = TC D = lizard D
  dplyr::select(date_time, temp_C = Value.3, Unit.3) %>%
  left_join(calibration_reference, by = 'date_time') %>%
  dplyr::filter(complete.cases(ref_temp_C))
```

Next, calculate and save regression curves:

```{r calculate thermocouple calibration curves}
# calculate regression curves
regression_a_dead <- lm(data = calibration_A,
                        temp_C ~ ref_temp_C) 
regression_d_dead <- lm(data = calibration_D,
                        temp_C ~ ref_temp_C)

# store calibration values
a_intercept <- coef(regression_a_dead)[1]
a_slope <- coef(regression_a_dead)[2]
d_intercept <- coef(regression_d_dead)[1]
d_slope <- coef(regression_d_dead)[2]
```

Finally, use calibration curves to correct the data we measured:

```{r apply thermocouple calibration curves}
all_dead_TC_data_calibrated <- all_dead_TC_data %>%
   mutate(calibrated_cloacal_temp_C = case_when(lizard_ID == "lizard A" ~
                                                  (a_intercept + temp_C*a_slope),
                                                lizard_ID == "lizard D" ~
                                                  (d_intercept + temp_C*d_slope))
                  )
summary(all_dead_TC_data_calibrated)
```





### Time Temp df

```{r join all dataframes}
CEWL_time_temp <- CEWL_time %>%
   left_join(all_dead_TC_data_calibrated, 
             by = c('date_time', 'lizard_ID', 'treatment')) %>%
   dplyr::select(-temp_C)

summary(CEWL_time_temp)

nrow(CEWL_time_temp) - 4711 # this is the # of temperature measurements we were able to apply
```

I double-checked we didn't miss attaching any temp data. We attached 65 temp measurements of the 93 we had, which is correct because ~10 temp datapoints were recorded before the aquaflux was started (in total across measurement periods) and we also trimmed the first minute off each measurement period.


## Subset Tmts/Individual

We did all 3 treatments on both individuals...
For lizard A, we did control, cooling, then heating.
For lizard D, we did control, heating, then cooling.

We've decided that we will present each lizard's control data, and the first treatment each lizard did. So, cooling for lizard A and heating for lizard D.

```{r}
A_ctrl_cool <- CEWL_time_temp %>%
  dplyr::filter(lizard_ID == "lizard A") %>%
  dplyr::filter(treatment %in% c("cooling", "control"))
summary(A_ctrl_cool)

D_ctrl_heat <- CEWL_time_temp %>%
  dplyr::filter(lizard_ID == "lizard D") %>%
  dplyr::filter(treatment %in% c("heating", "control"))
summary(D_ctrl_heat)

CEWL_time_temp_subset <- D_ctrl_heat %>%
  rbind(A_ctrl_cool)
summary(CEWL_time_temp_subset)
```




# Stats

Compare CEWL at a common body temp to the live lizards.

## Prep Dead Data

```{r}
mean_CEWL_temp_dead <- CEWL_time_temp_subset %>%
  mutate(rounded_cal_c_temp = round(calibrated_cloacal_temp_C, 0),
         # need to update format to join live lizard data
         treatment = factor(treatment, labels = c("Control", "Cooling", "Heating"))
         ) %>%
  dplyr::filter(complete.cases(rounded_cal_c_temp)) %>%
  group_by(treatment, rounded_cal_c_temp) %>%
  summarise(mean_CEWL = mean(CEWL_g_m2h)
            #n = n()
            )

mean_CEWL_temp_dead

summary(mean_CEWL_temp_dead)
```


## Join Dead & Live

### For Stats

```{r}
CEWL_per_temp_compare <- mean_CEWL_temp_dead %>% 
  dplyr::select(treatment, 
                rounded_cal_c_temp, 
                mean_CEWL_dead = mean_CEWL) %>%
  left_join(
    live_CEWL_per_temp, 
    by = c('treatment', 'rounded_cal_c_temp')
  ) %>% 
  mutate(
    dead_minus_live_diff = mean_CEWL_dead - mean_mean_CEWL
  ) %>% 
  dplyr::filter(complete.cases(dead_minus_live_diff))
```


### For Figs

```{r}
# prep ded
mean_CEWL_temp_dead_pretty <- mean_CEWL_temp_dead %>% 
  mutate(lizards = "Deceased")

# prep live
live_CEWL_per_temp_pretty <- live_CEWL_per_temp %>% 
  dplyr::select(treatment, rounded_cal_c_temp,
                mean_CEWL = mean_mean_CEWL) %>% 
  mutate(lizards = "Live")

CEWL_per_temp_compare_pretty <- mean_CEWL_temp_dead_pretty %>% 
  rbind(live_CEWL_per_temp_pretty) %>% 
  mutate(lizards = factor(lizards, levels = c("Live", "Deceased")))

summary(CEWL_per_temp_compare_pretty)
```


```{r}
# prep live liz data
live_CEWL_per_temp_sub <- live_CEWL_per_temp %>% 
  mutate(liz_tmt = paste("Live", treatment, sep = " - ")) %>% 
  dplyr::select(
    liz_tmt, 
    treatment,
    clo_temp = rounded_cal_c_temp,
    CEWL_g_m2h = mean_mean_CEWL,
    CEWL_sem
  ) %>% 
  # remove skewed pt bc of few indivs measured
  dplyr::filter(!(clo_temp == 16 & treatment == "Heating"))

raw_dead_vs_CEWL_per_temp_live <- CEWL_time_temp_subset %>% 
  # get rid of CEWL that's not linked to Tb
  # by doing this, we essentially recorded CEWL once every minute
  dplyr::filter(complete.cases(calibrated_cloacal_temp_C)) %>% 
  # subset to common/pertinent cols only
  dplyr::select(
    liz_tmt, 
    treatment,
    clo_temp = calibrated_cloacal_temp_C,
    CEWL_g_m2h
  ) %>% 
  mutate(CEWL_sem = NA) %>% 
  # ADD LIVE LIZARD DATA
  rbind(live_CEWL_per_temp_sub)
```









## Summarize

```{r}
CEWL_per_temp_compare %>%
  group_by(treatment) %>% 
  summarise(mean_diff = mean(dead_minus_live_diff), 
            sd_diff = sd(dead_minus_live_diff), 
            max_diff = max(dead_minus_live_diff), 
            min_diff = min(dead_minus_live_diff),
            n = n()) %>%
  mutate(sem_diff = sd_diff/sqrt(n))
```









# Figures

## color

```{r}
#cool <- c(brewer.pal(11, "Spectral")[c(10)])
#heat <- c(brewer.pal(11, "Spectral")[c(1)])
#control1 <- c(brewer.pal(11, "Spectral")[c(7)])
#control2 <- c(brewer.pal(11, "Spectral")[c(4)])

control <- c(brewer.pal(9, "Greys")[c(5)])
cool  <- c(brewer.pal(11, "RdBu")[c(11)])
heat  <- c(brewer.pal(11, "RdBu")[c(2)])
control1  <- c(brewer.pal(11, "RdBu")[c(8)]) # cooling lizard
control2  <- c(brewer.pal(11, "RdBu")[c(4)]) # heating lizard
```


## * CEWL (relative) ~ time


```{r relative CEWL time}
ggplot(CEWL_time_temp_subset) +
  
  geom_hline(yintercept = 0, size = 0.5,
              linetype = "dashed", color = "black") +
  
  geom_line(aes(x= time_min, 
                  y = relative_CEWL,
                  color = liz_tmt)) +
   
   theme_classic() +
   theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 8),
        legend.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 12),
        axis.title.y = element_text(vjust = -1),
        legend.position = "none",
        plot.margin = margin(t = 1, r = 1, b = 4, l = 1, unit = "pt")) +
  
   scale_color_manual(values = c("A control" = control1,
                                 "D control" = control2,
                                     "A cooling" = cool,  
                                     "D heating" = heat),
                      name = "Treatment") +
  scale_x_continuous(limits = c(1, 15), 
                      breaks = seq(1, 15, 2)) +
  
   annotate("text", label = "Cooling", 
            x = 14.5, y = -8.5, size = 2.9, color = cool) +
   annotate("text", label = "Control[Cool]", parse = T,
            x = 14.2, y = -3, size = 2.5, color = control1) + 
   
   annotate("text", label = "Heating", 
            x = 14.5, y = 24, size = 2.9, color = heat) +
   annotate("text", label = "Control[Heat]", parse = T,
            x = 14.2, y = 5, size = 2.5, color = control2) + 

   labs(x = "Time (minutes)" , 
        y = bquote('Relative CEWL (g '*m^-2*' '*h^-1*')')) -> CEWLr_time
  
CEWLr_time
```

```{r}
ggsave(filename = "CEWL_relative_time_dead.pdf",
       plot = CEWLr_time,
       path = "./Results_Figures",
       device = "pdf",
       dpi = 600,
       units = "mm",
       width = 150, height = 100)
```




## CEWL (raw) ~ cloacal temperature

note, there is a warning that 3132 rows were removed because they do not have cloacal temperature values

```{r CEWL cloacal temp}
ggplot(CEWL_time_temp_subset) +
   geom_point(aes(x = (calibrated_cloacal_temp_C), 
       y = CEWL_g_m2h,
       shape = treatment,
       color = liz_tmt),
       size = 2, 
       alpha = 1) +
  geom_smooth(aes(x = (calibrated_cloacal_temp_C), 
       y = CEWL_g_m2h,
       color = liz_tmt),
       method = "lm", 
        formula = y ~ poly(x, 2),
               size = 1, 
               se = F) +
  scale_x_continuous(limits = c(11, 36.5),
                     breaks = c(seq(15, 35, 5)),
                     labels = c(seq(15, 35, 5))) +

  # control group
   annotate("text", x = 29.8, y = 29, label = "Control[Heat]", parse = T,
           size = 3, family = "sans", color = control2) +
  annotate("text", x = 29.2, y = 22, label = "Control[Cool]", parse = T,
           size = 3, family = "sans", color = control1) +
  
  # annotations for cooling group
  annotate("text", label = "Cooling", 
            x = 19, y = 9, size = 4, color = cool) +
  annotate("text", x = 11, y = 2.5, label = "T[15]", parse = T,
           size = 5, family = "sans", color = cool) +
  annotate("text", x = 29, y = 8.5, label = "T[1]", parse = T,
           size = 5, family = "sans", color = cool) +
  
  # annotations for heating group
  annotate("text", label = "Heating", 
            x = 28, y = 59, size = 4, color = heat) +
   annotate("text", x = 20.1, y = 40, label = "T[1]", parse = T,
           size = 5, family = "sans", color = heat) +
   annotate("text", x = 36.5, y = 65, label = "T[15]", parse = T,
           size = 5, family = "sans", color = heat) +
   
   theme_classic() +
   theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 8),
        legend.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 12),
        legend.position = "none",
        plot.margin = margin(t = 6, r = 6, b = 6, l = 10, unit = "pt")) +
  
   scale_color_manual(values = c("A control" = control1,
                                 "D control" = control2,
                                     "A cooling" = cool,  
                                     "D heating" = heat),
                      name = "Treatment") +
  scale_shape_manual(values = c(21,25,24),
                     name = "Treatment") + 
  
   labs(x = "Internal Body Temperature (°C)" , 
        y = bquote('CEWL (g '*m^-2*' '*h^-1*')'), 
        se = FALSE) -> CEWL_ctemp
CEWL_ctemp
```

```{r}
ggsave(filename = "CEWL_temp_dead.pdf",
       plot = CEWL_ctemp,
       path = "./Results_Figures",
       device = "pdf",
       dpi = 600,
       units = "mm",
       width = 140, height = 200)
```





## * CEWL ~ temp (mean live vs raw ded)

```{r}
ggplot(raw_dead_vs_CEWL_per_temp_live) +
  geom_point(
    aes(
      x = clo_temp,
      y = CEWL_g_m2h,
      color = liz_tmt,
      fill = liz_tmt,
      shape = liz_tmt
    ),
    alpha = 0.7
  ) +
 
   theme_classic() +
   theme(text = element_text(color = "black", 
                            family = "sans", 
                            size = 12),
        axis.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 8),
        legend.text = element_text(color = "black", 
                                 family = "sans", 
                                 size = 12),
        legend.position = "none",
        plot.margin = margin(t = 1, r = 1, b = 1, l = 6, unit = "pt")) +
   
  scale_x_continuous(limits = c(10, 40),
                     breaks = c(seq(10, 40, 5)),
                     labels = c(seq(10, 40, 5))) +
  scale_color_manual(values = c("A control" = control1,
                                "A cooling" = cool,
                                "D control" = control2,
                                "D heating" = heat,
                                "Live - Control" = control,
                                "Live - Cooling" = cool,
                                "Live - Heating" = heat
                                ),
                      name = "Treatment") +
  scale_fill_manual(values = c("A control" = control1,
                                "A cooling" = cool,
                                "D control" = control2,
                                "D heating" = heat,
                                "Live - Control" = control,
                                "Live - Cooling" = cool,
                                "Live - Heating" = heat
                                ),
                      name = "Treatment") +
     # open shapes for dead, closed for live
  scale_shape_manual(values = c("A control" = 21,
                                "A cooling" = 21,
                                "D control" = 21,
                                "D heating" = 21,
                                "Live - Control" = 1,
                                "Live - Cooling" = 6,
                                "Live - Heating" = 2),
                     name = "Treatment") + 
  
   # control group
  annotate("text", x = 22.2, y = 32, label = "Deceased[Control]", # "D-Control[Heat]", 
           parse = T,
           size = 2.5, family = "sans", color = control2) +
  annotate("text", x = 21.5, y = 25, label = "Deceased[Control]", parse = T,
           size = 2.5, family = "sans", color = control1) +
  
  # annotations for cooling group
  annotate("text", label = "Deceased[Cool]", parse = T,
            x = 13, y = 6, size = 2.5, color = cool) +
  annotate("text", x = 10.5, y = 1, label = "T[15]", parse = T,
           size = 3, family = "sans", color = cool) +
  annotate("text", x = 29, #x = 36.5, 
           y = 2.5, label = "T[1]", parse = T,
           size = 3, family = "sans", color = cool) +
  
  # annotations for heating group - dead
  annotate("text", label = "Deceased[Heat]",parse = T, # dead
            x = 28.5, y = 58, size = 2.5, color = heat) +
  annotate("text", x = 20.1, y = 40, label = "T[1]", parse = T,
           size = 3, family = "sans", color = heat) +
  annotate("text", x = 36.5, y = 67, label = "T[15]", parse = T,
           size = 3, family = "sans", color = heat) +
  
  # annotations for live lizards
  annotate("text", label = "Live[Heat]", parse = T,# live
            x = 37, y = 20, size = 2.5, color = heat) +
  annotate("text", label = "Live[Cool]", parse = T,# live
            x = 37, y = 12, size = 2.5, color = cool) +
  annotate("text", x = 24, y = 13, label = "Live[Control]", parse = T,
           size = 2.5, family = "sans", color = control) +

   labs(x = expression('T'[b]~' (°C)'),
        y = bquote('CEWL (g '*m^-2*' '*h^-1*')')) -> dead_vs_live_fig
dead_vs_live_fig
```






## CEWL ~ avg temp (live vs ded)

```{r}
ggplot(CEWL_per_temp_compare_pretty) +
  geom_point(
    aes(
      x = rounded_cal_c_temp,
      y = mean_CEWL,
      color = treatment,
      shape = lizards
    )
  ) +
  theme_classic()
```















# Export Multi-Pane Figures


## Original

```{r}
# arrange
dead_arrange <- ggarrange(CEWLr_time, CEWL_ctemp,
                          nrow = 2, ncol = 1,
                          heights = c(1,1),
                          labels = c("A", "B"))
dead_arrange

# export
ggsave(filename = "dead_lizards_time_and_temp_figs.pdf",
       plot = dead_arrange,
       path = "./Results_Figures",
       device = "pdf",
       dpi = 600,
       units = "mm",
       width = 120, height = 160)
```



## * Updated

```{r}
dead_arrange2 <- ggarrange(CEWLr_time, 
                           dead_vs_live_fig,
                           nrow = 1, ncol = 2,
                           widths = c(1,1),
                           labels = c("(a)", "(b)"),
                           font.label = list(color = "black", 
                                             face = "bold", 
                                             size = 10)
                           )

# export
ggsave(filename = "dead_liz_time_temp_new.tiff",
       plot = dead_arrange2,
       path = "./Results_Figures",
       device = "tiff",
       dpi = 600,
       units = "mm",
       width = 160, height = 70)
```















